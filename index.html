<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RN Roadmap — React Native to Senior Engineer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <style>
      :root {
        /* 2026 Premium Dark Mode Palette */
        --bg: #050505;
        --glass-bg: rgba(20, 22, 28, 0.5);
        --glass-hover: rgba(30, 34, 42, 0.6);
        --glass-border: rgba(255, 255, 255, 0.06);
        --glass-border-hover: rgba(255, 255, 255, 0.12);

        --txt: #f8fafc;
        --txt2: #94a3b8;
        --txt3: #64748b;

        --blue: #3b82f6;
        --blue-glow: rgba(59, 130, 246, 0.4);
        --purple: #8b5cf6;
        --purple-glow: rgba(139, 92, 246, 0.4);
        --gold: #f59e0b;
        --gold-glow: rgba(245, 158, 11, 0.4);
        --green: #10b981;
        --green-glow: rgba(16, 185, 129, 0.4);
        --red: #ef4444;
        --cyan: #06b6d4;
        --orange: #f97316;

        --w1: #6366f1;
        --w2: #8b5cf6;
        --w3: #10b981;
        --w4: #059669;
        --w5: #f97316;
        --w6: #ea580c;
        --w7: #eab308;
        --w8: #ca8a04;

        --nav: 70px;
        --sidebar: 260px;
        --sidebar-col: 80px;
        --right: 320px;
        --right-col: 80px;
        --sb-left: var(--sidebar);
        --sb-right: var(--right);

        --spring: cubic-bezier(0.175, 0.885, 0.32, 1.15);
        --transition-sb: 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        --radius-lg: 24px;
        --radius-md: 16px;
        --radius-sm: 10px;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: "Bricolage Grotesque", system-ui, sans-serif;
        background-color: var(--bg);
        /* Ambient Mesh Gradient Background */
        background-image:
          radial-gradient(
            circle at 10% 0%,
            rgba(59, 130, 246, 0.15) 0px,
            transparent 40%
          ),
          radial-gradient(
            circle at 90% 20%,
            rgba(139, 92, 246, 0.1) 0px,
            transparent 40%
          ),
          radial-gradient(
            circle at 50% 100%,
            rgba(16, 185, 129, 0.05) 0px,
            transparent 50%
          );
        background-attachment: fixed;
        color: var(--txt);
        line-height: 1.6;
        overflow-x: hidden;
        transition: background 0.5s ease;
      }

      body.focus-mode {
        background-image: radial-gradient(
          circle at 50% 50%,
          rgba(59, 130, 246, 0.1) 0px,
          transparent 60%
        );
      }
      body.focus-mode .sidebar,
      body.focus-mode .right-sidebar,
      body.focus-mode .milestone-section,
      body.focus-mode .hero {
        opacity: 0.2;
        filter: grayscale(100%) blur(4px);
        pointer-events: none;
      }
      body.focus-mode .focus-section {
        transform: scale(1.03);
        box-shadow: 0 0 50px rgba(59, 130, 246, 0.15);
        z-index: 1000;
        position: relative;
      }

      a {
        color: inherit;
        text-decoration: none;
      }
      button {
        cursor: pointer;
        font-family: inherit;
        transition:
          transform 0.2s var(--spring),
          filter 0.2s,
          background 0.2s;
      }
      button:active {
        transform: scale(0.92);
      }
      input {
        font-family: inherit;
      }
      i.ph {
        font-size: 1.2em;
        vertical-align: middle;
      }

      /* ── UI COMPONENTS: GLASSMORPHISM ── */
      .glass-panel {
        background: var(--glass-bg);
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      }

      /* ── TOPBAR ── */
      .topbar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--nav);
        z-index: 200;
        display: flex;
        align-items: center;
        padding: 0 1.5rem;
        gap: 1.5rem;
        border-bottom: 1px solid var(--glass-border);
        background: rgba(5, 5, 5, 0.7);
        backdrop-filter: blur(20px);
      }
      .topbar-logo {
        display: flex;
        align-items: center;
        gap: 0.6rem;
        font-weight: 800;
        font-size: 1.2rem;
        letter-spacing: -0.02em;
      }
      .topbar-logo i {
        font-size: 1.4rem;
        color: var(--blue);
        filter: drop-shadow(0 0 8px var(--blue-glow));
      }
      .topbar-spacer {
        flex: 1;
      }
      .topbar-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .streak-badge {
        display: flex;
        align-items: center;
        gap: 0.4rem;
        background: linear-gradient(
          145deg,
          rgba(245, 158, 11, 0.15),
          rgba(245, 158, 11, 0.05)
        );
        border: 1px solid rgba(245, 158, 11, 0.2);
        border-radius: 20px;
        padding: 0.4rem 1rem;
        font-size: 0.9rem;
        font-weight: 700;
        color: var(--gold);
      }
      .icon-btn {
        width: 42px;
        height: 42px;
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--txt2);
      }
      .icon-btn:hover {
        background: var(--glass-hover);
        border-color: var(--txt);
        color: var(--txt);
      }

      /* ── LAYOUT & MAIN (Fixes the gap) ── */
      .layout {
        display: flex; /* Flex is much more reliable for collapsing side panels than CSS Grid */
        padding-top: var(--nav);
        min-height: 100vh;
      }
      .main {
        flex-grow: 1;
        padding: 2.5rem 2rem;
        max-width: 1050px;
        margin: 0 auto;
        transition: all var(--transition-sb);
        width: 100%;
      }

      /* ── LEFT SIDEBAR (Fixes the overlapping glass) ── */
      .sidebar {
        position: sticky; /* Changed from fixed to sticky so it pushes content properly */
        top: var(--nav);
        height: calc(100vh - var(--nav));
        width: var(--sidebar);
        flex-shrink: 0;
        border-right: 1px solid var(--glass-border);
        overflow-y: auto;
        overflow-x: hidden;
        padding: 1.5rem 0;
        z-index: 100;
        transition: width var(--transition-sb);
        background: rgba(10, 12, 16, 0.4);
        backdrop-filter: blur(12px);
      }
      .sidebar.collapsed {
        width: var(--sidebar-col); /* Shrinks perfectly to 80px */
      }
      .sidebar::-webkit-scrollbar {
        display: none;
      }
      .sidebar-toggle-btn {
        width: calc(100% - 2rem);
        margin: 0 1rem 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.75rem 1rem;
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-sm);
        color: var(--txt2);
        font-size: 0.85rem;
        font-weight: 600;
      }
      .sidebar-toggle-btn:hover {
        background: var(--glass-hover);
        color: var(--txt);
      }
      .sidebar.collapsed .sidebar-toggle-btn {
        width: 48px;
        margin: 0 auto 1.5rem;
        padding: 0.75rem 0;
        justify-content: center;
      }
      .sidebar.collapsed .sb-toggle-label {
        display: none;
      }
      .sidebar-label {
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.15em;
        color: var(--txt3);
        padding: 0 1.5rem;
        margin-bottom: 0.75rem;
        white-space: nowrap;
        transition: opacity 0.2s;
      }
      .sidebar.collapsed .sidebar-label {
        opacity: 0;
      }

      .sidebar-item {
        display: flex;
        flex-direction: column;
        padding: 1rem 1.5rem;
        cursor: pointer;
        border-right: 3px solid transparent;
        transition: all 0.3s var(--spring);
        margin-bottom: 0.25rem;
        white-space: nowrap;
      }
      .sidebar-item:hover {
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.03)
        );
        padding-left: 1.75rem;
        color: #fff;
      }
      .sidebar-item.active {
        background: linear-gradient(
          90deg,
          transparent,
          rgba(59, 130, 246, 0.1)
        );
        border-right-color: var(--blue);
      }
      .sidebar-item.active.m2 {
        border-right-color: var(--purple);
        background: linear-gradient(
          90deg,
          transparent,
          rgba(139, 92, 246, 0.1)
        );
      }
      .sidebar-item.active.m3 {
        border-right-color: var(--gold);
        background: linear-gradient(
          90deg,
          transparent,
          rgba(245, 158, 11, 0.1)
        );
      }

      .sidebar-title {
        font-size: 0.95rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .sidebar.collapsed .sidebar-title .sb-text {
        display: none;
      }
      .sidebar.collapsed .sidebar-item {
        padding: 1rem 0;
        align-items: center;
        border-right: none;
        border-radius: var(--radius-sm);
        margin: 0.5rem 1rem;
      }
      .sidebar.collapsed .sidebar-item.active {
        background: rgba(59, 130, 246, 0.15);
        box-shadow: 0 0 15px var(--blue-glow);
        border-radius: var(--radius-md);
      }
      .sidebar.collapsed .sidebar-item.active.m2 {
        background: rgba(139, 92, 246, 0.15);
        box-shadow: 0 0 15px var(--purple-glow);
        border-radius: var(--radius-md);
      }
      .sidebar.collapsed .sidebar-item.active.m3 {
        background: rgba(245, 158, 11, 0.15);
        box-shadow: 0 0 15px var(--gold-glow);
        border-radius: var(--radius-md);
      }
      .sidebar.collapsed .sidebar-sub,
      .sidebar.collapsed .sidebar-pct,
      .sidebar.collapsed .sidebar-bar {
        display: none;
      }
      .sidebar-icon-only {
        font-size: 1.3rem;
        color: var(--txt2);
        transition: color 0.3s;
      }
      .sidebar-item.active .sidebar-icon-only {
        color: var(--blue);
      }
      .sidebar-item.active.m2 .sidebar-icon-only {
        color: var(--purple);
      }
      .sidebar-item.active.m3 .sidebar-icon-only {
        color: var(--gold);
      }

      .sidebar-sub {
        font-size: 0.8rem;
        color: var(--txt3);
        margin-top: 0.3rem;
      }
      .sidebar-pct {
        font-size: 0.75rem;
        font-family: "JetBrains Mono", monospace;
        color: var(--txt2);
        margin-top: 0.5rem;
        font-weight: 600;
      }
      .sidebar-bar {
        height: 4px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 2px;
        margin-top: 0.5rem;
        overflow: hidden;
      }
      .sidebar-bar-fill {
        height: 100%;
        border-radius: 2px;
        transition: width 0.6s var(--spring);
      }

      /* ── RIGHT SIDEBAR ── */
      .right-sidebar {
        position: sticky;
        top: var(--nav);
        height: calc(100vh - var(--nav));
        width: var(--right);
        flex-shrink: 0;
        border-left: 1px solid var(--glass-border);
        overflow-y: auto;
        overflow-x: hidden;
        padding: 1.5rem;
        z-index: 100;
        transition: width var(--transition-sb);
        background: rgba(10, 12, 16, 0.4);
        backdrop-filter: blur(12px);
      }
      .right-sidebar.collapsed {
        width: var(--right-col);
        padding: 1.5rem 0.5rem;
      }
      .right-sidebar::-webkit-scrollbar {
        display: none;
      }
      .right-sidebar.collapsed {
        width: var(--right-col);
        padding: 1.5rem 0.5rem;
      }
      .rside-toggle {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-sm);
        color: var(--txt2);
        font-size: 0.85rem;
        font-weight: 600;
        padding: 0.75rem 1rem;
        margin-bottom: 1.5rem;
      }
      .rside-toggle:hover {
        background: var(--glass-hover);
        color: var(--txt);
      }
      .right-sidebar.collapsed .rside-toggle {
        justify-content: center;
        padding: 0.75rem 0;
        width: 48px;
        margin: 0 auto 1.5rem;
      }
      .right-sidebar.collapsed .rside-toggle-label {
        display: none;
      }
      .right-sidebar.collapsed .jst-full {
        display: none;
      }
      .right-sidebar.collapsed .jst-mini {
        display: flex;
      }

      .jst-mini {
        display: none;
        flex-direction: column;
        gap: 1.5rem;
        align-items: center;
      }
      .jst-mini-row {
        text-align: center;
      }
      .jst-mini-val {
        font-family: "JetBrains Mono", monospace;
        font-size: 1.1rem;
        font-weight: 800;
        display: block;
        text-shadow: 0 0 10px currentColor;
      }
      .jst-mini-lbl {
        font-size: 0.65rem;
        color: var(--txt3);
        text-transform: uppercase;
        font-weight: 700;
      }

      .jst-full {
        padding: 1.5rem;
        border-radius: var(--radius-lg);
        border: 1px solid var(--glass-border);
        background: linear-gradient(180deg, rgba(30, 34, 40, 0.4), transparent);
      }
      .jst-title {
        font-weight: 800;
        font-size: 1.1rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        letter-spacing: -0.02em;
      }
      .jst-title i {
        color: var(--blue);
        font-size: 1.2rem;
      }
      .jst-metric {
        margin-bottom: 1.2rem;
        background: rgba(0, 0, 0, 0.3);
        padding: 1rem;
        border-radius: var(--radius-md);
        border: 1px solid rgba(255, 255, 255, 0.03);
      }
      .jst-label {
        font-size: 0.8rem;
        color: var(--txt2);
        font-weight: 600;
        margin-bottom: 0.5rem;
        display: flex;
        justify-content: space-between;
      }
      .jst-target {
        font-family: "JetBrains Mono", monospace;
        color: var(--txt3);
      }
      .jst-row {
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .jst-input {
        width: 70px;
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-sm);
        padding: 0.4rem;
        color: var(--txt);
        font-family: "JetBrains Mono", monospace;
        font-size: 1.1rem;
        font-weight: 700;
        text-align: center;
        outline: none;
        transition: all 0.2s;
      }
      .jst-input:focus {
        border-color: var(--blue);
        box-shadow: 0 0 0 2px var(--blue-glow);
      }
      .jst-bar {
        flex: 1;
        height: 6px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
        overflow: hidden;
      }
      .jst-bar-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.8s var(--spring);
      }
      .jst-cta {
        width: 100%;
        margin-top: 1rem;
        padding: 1rem;
        background: linear-gradient(135deg, var(--blue), #2563eb);
        color: #fff;
        border: none;
        border-radius: var(--radius-md);
        font-weight: 800;
        font-size: 0.95rem;
        letter-spacing: 0.02em;
        box-shadow: 0 4px 15px var(--blue-glow);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }
      .jst-cta:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 8px 25px var(--blue-glow);
      }

      /* ── STREAK & TIPS ── */
      .streak-banner {
        display: none;
        align-items: center;
        gap: 1rem;
        background: linear-gradient(
          135deg,
          rgba(245, 158, 11, 0.1),
          rgba(239, 68, 68, 0.05)
        );
        border: 1px solid rgba(245, 158, 11, 0.2);
        border-radius: var(--radius-md);
        padding: 1rem 1.5rem;
        margin-bottom: 2rem;
        backdrop-filter: blur(10px);
      }
      .streak-banner.show {
        display: flex;
        animation: slide-in-top 0.5s var(--spring);
      }
      .mini-timer-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(59, 130, 246, 0.1);
        border: 1px solid rgba(59, 130, 246, 0.2);
        border-radius: 20px;
        padding: 0.4rem 1.2rem;
        font-family: "JetBrains Mono", monospace;
        font-size: 0.95rem;
        font-weight: 700;
        color: var(--blue);
        transition: all 0.2s;
      }
      .mini-timer-btn:hover {
        background: rgba(59, 130, 246, 0.2);
        border-color: var(--blue);
      }
      .mini-timer-btn.running {
        background: rgba(16, 185, 129, 0.15);
        border-color: var(--green);
        color: var(--green);
        box-shadow: 0 0 15px var(--green-glow);
        animation: pulse-border 2s infinite;
      }

      /* ── HERO ── */
      .hero {
        margin-bottom: 3rem;
      }
      .hero-title {
        font-size: clamp(2rem, 4vw, 3.5rem);
        font-weight: 800;
        background: linear-gradient(135deg, #fff 40%, var(--txt3));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: -0.03em;
        line-height: 1.1;
        margin-bottom: 0.75rem;
      }
      .hero-sub {
        color: var(--txt2);
        font-size: 1.1rem;
        font-weight: 500;
        margin-bottom: 2rem;
        max-width: 600px;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .hero-sub i {
        color: var(--blue);
      }

      .stats-row {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1rem;
      }
      .stat-box {
        padding: 1.25rem;
        text-align: center;
        transition: transform 0.2s var(--spring);
      }
      .stat-box:hover {
        transform: translateY(-4px);
        border-color: var(--glass-border-hover);
      }
      .stat-val {
        font-family: "JetBrains Mono", monospace;
        font-size: 1.8rem;
        font-weight: 800;
        color: var(--txt);
        display: block;
        margin-bottom: 0.25rem;
      }
      .stat-lbl {
        font-size: 0.75rem;
        color: var(--txt3);
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.1em;
      }

      /* ── TODAY'S FOCUS (Bento Setup) ── */
      .focus-section {
        padding: 1.75rem;
        margin-bottom: 3rem;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }
      .focus-section::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: var(--blue);
        box-shadow: 0 0 15px var(--blue);
      }
      .focus-header {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
      }
      .focus-title {
        font-weight: 800;
        font-size: 1.2rem;
        color: #fff;
        letter-spacing: -0.02em;
      }
      .focus-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }
      .focus-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.03);
        border-radius: var(--radius-md);
        font-size: 0.95rem;
        font-weight: 500;
        transition: all 0.2s;
      }
      .focus-item:hover {
        background: rgba(255, 255, 255, 0.03);
        border-color: var(--glass-border);
      }
      .focus-empty {
        color: var(--green);
        font-size: 1rem;
        font-weight: 600;
        text-align: center;
        padding: 1.5rem 0;
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        align-items: center;
      }

      /* ── MILESTONES ── */
      .milestone-section {
        margin-bottom: 3rem;
      }
      .milestone-header {
        display: flex;
        align-items: center;
        gap: 1.25rem;
        padding: 1.5rem;
        cursor: pointer;
        margin-bottom: 1.5rem;
        transition: all 0.3s var(--spring);
      }
      .milestone-header:hover {
        transform: scale(1.01);
        background: var(--glass-hover);
        border-color: var(--glass-border-hover);
      }
      .milestone-icon {
        font-size: 2rem;
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.05);
      }
      .m1-header .milestone-icon {
        color: var(--blue);
        box-shadow: 0 0 20px var(--blue-glow);
      }
      .m2-header .milestone-icon {
        color: var(--purple);
        box-shadow: 0 0 20px var(--purple-glow);
      }
      .m3-header .milestone-icon {
        color: var(--gold);
        box-shadow: 0 0 20px var(--gold-glow);
      }

      .milestone-info {
        flex: 1;
      }
      .milestone-name {
        font-weight: 800;
        font-size: 1.3rem;
        letter-spacing: -0.02em;
        margin-bottom: 0.2rem;
      }
      .milestone-sub {
        font-size: 0.9rem;
        color: var(--txt3);
        font-weight: 500;
      }
      .milestone-prog {
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .milestone-pct-text {
        font-family: "JetBrains Mono", monospace;
        font-size: 1rem;
        font-weight: 800;
        color: var(--txt);
      }
      .milestone-bar {
        width: 120px;
        height: 6px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
        overflow: hidden;
      }
      .milestone-bar-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.8s var(--spring);
      }
      .milestone-toggle {
        font-size: 1.2rem;
        color: var(--txt3);
        transition: transform 0.4s var(--spring);
      }
      .milestone-toggle.open {
        transform: rotate(180deg);
        color: var(--txt);
      }
      .milestone-body {
        display: none;
        animation: fadeIn 0.4s ease;
      }
      .milestone-body.open {
        display: block;
      }

      /* ── WEEK CARD (Bento Style) ── */
      .week-card {
        margin-bottom: 1.5rem;
        overflow: hidden;
        transition: all 0.3s var(--spring);
        position: relative;
      }
      .week-card:hover {
        border-color: var(--glass-border-hover);
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }
      .week-card-top {
        height: 4px;
        width: 100%;
      }
      .wc-header {
        padding: 1.5rem;
        cursor: pointer;
        display: flex;
        align-items: flex-start;
        gap: 1.5rem;
      }
      .wc-left {
        flex: 1;
        min-width: 0;
      }
      .wc-num {
        font-family: "JetBrains Mono", monospace;
        font-size: 0.75rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        display: flex;
        align-items: center;
        gap: 0.4rem;
      }
      .wc-title {
        font-weight: 800;
        font-size: 1.2rem;
        margin-bottom: 0.3rem;
        letter-spacing: -0.01em;
      }
      .wc-subtitle {
        font-size: 0.9rem;
        color: var(--txt3);
        font-weight: 500;
      }
      .wc-right {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 0.75rem;
        flex-shrink: 0;
      }
      .wc-prog-row {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }
      .wc-prog-bar {
        width: 80px;
        height: 6px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 3px;
        overflow: hidden;
      }
      .wc-prog-fill {
        height: 100%;
        border-radius: 3px;
        transition: width 0.5s var(--spring);
      }
      .wc-pct {
        font-family: "JetBrains Mono", monospace;
        font-size: 0.8rem;
        font-weight: 700;
        color: var(--txt2);
      }
      .wc-arrow {
        color: var(--txt3);
        transition: transform 0.4s var(--spring);
        font-size: 1.2rem;
      }
      .wc-arrow.open {
        transform: rotate(180deg);
        color: var(--txt);
      }

      .wc-body {
        padding: 0 1.5rem 1.5rem;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        display: grid;
        grid-template-rows: 1fr;
        transition: grid-template-rows 0.4s var(--spring);
      }
      .wc-body.hidden {
        grid-template-rows: 0fr;
        padding: 0 1.5rem;
        border-top: none;
        opacity: 0;
        pointer-events: none;
        overflow: hidden;
      }
      .wc-body-inner {
        min-height: 0;
      }

      .wc-bento-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin: 1.5rem 0;
      }
      .info-box {
        border-radius: var(--radius-md);
        padding: 1.25rem;
        font-size: 0.9rem;
        border: 1px solid transparent;
        background: rgba(0, 0, 0, 0.3);
      }
      .info-box.interview {
        border-color: rgba(16, 185, 129, 0.2);
        box-shadow: inset 0 0 20px rgba(16, 185, 129, 0.05);
      }
      .info-box.deliverable {
        border-color: rgba(59, 130, 246, 0.2);
        box-shadow: inset 0 0 20px rgba(59, 130, 246, 0.05);
      }
      .info-box.mistakes {
        border-color: rgba(239, 68, 68, 0.2);
        grid-column: 1 / -1;
        box-shadow: inset 0 0 20px rgba(239, 68, 68, 0.05);
      }
      .box-title {
        font-weight: 800;
        margin-bottom: 0.6rem;
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .interview .box-title {
        color: var(--green);
      }
      .deliverable .box-title {
        color: var(--blue);
      }
      .mistakes .box-title {
        color: var(--red);
      }
      .box-text {
        color: var(--txt2);
        font-weight: 500;
      }
      .mistakes ul {
        list-style: none;
        padding-left: 0;
        margin-top: 0.5rem;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.75rem;
      }
      .mistakes li {
        color: var(--txt2);
        font-size: 0.85rem;
        display: flex;
        align-items: flex-start;
        gap: 0.5rem;
      }
      .mistakes li i {
        color: var(--red);
        margin-top: 0.2rem;
      }

      /* ── TASK ITEM (Interactive & Squishy) ── */
      .task-list {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        margin-bottom: 1.5rem;
      }
      .task-item {
        display: flex;
        align-items: flex-start;
        gap: 1rem;
        padding: 1rem 1.25rem;
        background: rgba(0, 0, 0, 0.2);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: var(--radius-md);
        cursor: pointer;
        transition: all 0.2s var(--spring);
        position: relative;
      }
      .task-item:hover {
        background: rgba(255, 255, 255, 0.03);
        border-color: rgba(255, 255, 255, 0.1);
        transform: scale(1.01);
      }
      .task-item:active {
        transform: scale(0.98);
      }
      .task-item.done {
        background: rgba(16, 185, 129, 0.05);
        border-color: rgba(16, 185, 129, 0.2);
        opacity: 0.8;
      }
      .task-item.done:hover {
        transform: scale(1.01);
      }

      .task-cb {
        width: 24px;
        height: 24px;
        border: 2px solid var(--border2);
        border-radius: 8px;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s var(--spring);
        background: rgba(0, 0, 0, 0.3);
        color: transparent;
      }
      .task-item:hover .task-cb {
        border-color: var(--txt3);
      }
      .task-cb.checked {
        background: var(--green);
        border-color: var(--green);
        box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        color: #000;
      }

      .task-content {
        flex: 1;
        min-width: 0;
      }
      .task-text {
        font-size: 0.95rem;
        font-weight: 600;
        color: var(--txt);
        line-height: 1.4;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        flex-wrap: wrap;
      }
      .task-item.done .task-text {
        text-decoration: line-through;
        color: var(--txt3);
        font-weight: 500;
      }

      .task-meta {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        flex-wrap: wrap;
      }
      .task-time {
        background: rgba(255, 255, 255, 0.05);
        color: var(--txt2);
        padding: 0.2rem 0.6rem;
        border-radius: 6px;
        font-size: 0.75rem;
        font-family: "JetBrains Mono", monospace;
        font-weight: 600;
        border: 1px solid rgba(255, 255, 255, 0.05);
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }
      .task-why {
        font-size: 0.85rem;
        color: var(--txt3);
        font-weight: 500;
        font-style: italic;
      }
      .task-res {
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
        padding: 0.2rem 0.6rem;
        border-radius: 6px;
        font-size: 0.7rem;
        font-family: "JetBrains Mono", monospace;
        font-weight: 700;
        border: 1px solid transparent;
        transition: all 0.2s;
      }
      .task-res.res-docs {
        background: rgba(56, 189, 248, 0.1);
        color: #38bdf8;
        border-color: rgba(56, 189, 248, 0.2);
      }

      .task-note-btn {
        background: rgba(255, 255, 255, 0.05);
        border: none;
        border-radius: 6px;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        color: var(--txt3);
        margin-left: auto;
      }
      .task-note-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--txt);
      }
      .task-note-btn.has-note {
        background: rgba(245, 158, 11, 0.15);
        color: var(--gold);
      }

      /* ── ANIMATIONS ── */
      @keyframes check-pop {
        0% {
          transform: scale(0) rotate(-15deg);
        }
        50% {
          transform: scale(1.3) rotate(10deg);
        }
        100% {
          transform: scale(1) rotate(0);
        }
      }
      .task-cb.checked i {
        animation: check-pop 0.4s var(--spring);
      }
      @keyframes slide-in-top {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      @keyframes pulse-border {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4);
        }
        50% {
          box-shadow: 0 0 0 6px rgba(16, 185, 129, 0);
        }
      }

      /* ── MODALS & TOAST ── */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.8);
        backdrop-filter: blur(8px);
        z-index: 500;
        display: none;
        align-items: center;
        justify-content: center;
      }
      .modal-overlay.open {
        display: flex;
        animation: fadeIn 0.2s ease;
      }
      .modal {
        background: var(--bg-s);
        backdrop-filter: blur(24px);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: 2rem;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        transform: scale(0.95);
        transition: transform 0.3s var(--spring);
      }
      .modal-overlay.open .modal {
        transform: scale(1);
      }
      .modal-title {
        font-weight: 800;
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .modal-textarea {
        width: 100%;
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid var(--border2);
        border-radius: var(--radius-sm);
        padding: 1rem;
        color: var(--txt);
        font-size: 0.95rem;
        resize: vertical;
        min-height: 150px;
        outline: none;
        font-family: inherit;
      }
      .modal-textarea:focus {
        border-color: var(--blue);
        box-shadow: inset 0 0 0 1px var(--blue);
      }
      .modal-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        margin-top: 1.5rem;
      }
      .btn-primary {
        background: var(--blue);
        color: #fff;
        border: none;
        border-radius: var(--radius-sm);
        padding: 0.75rem 1.5rem;
        font-weight: 700;
      }
      .btn-secondary {
        background: rgba(255, 255, 255, 0.05);
        color: var(--txt);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-sm);
        padding: 0.75rem 1.5rem;
        font-weight: 600;
      }

      /* Timer Specifics */
      .timer-display {
        text-align: center;
        padding: 2rem 0;
      }
      .timer-time {
        font-family: "JetBrains Mono", monospace;
        font-size: 5rem;
        font-weight: 800;
        color: var(--txt);
        text-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
        letter-spacing: -0.05em;
      }
      .timer-controls {
        display: flex;
        gap: 1rem;
        justify-content: center;
      }

      .toast {
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%) translateY(20px);
        background: var(--bg-s);
        backdrop-filter: blur(16px);
        border: 1px solid var(--glass-border);
        color: var(--txt);
        padding: 1rem 2rem;
        border-radius: 100px;
        font-size: 0.95rem;
        font-weight: 600;
        opacity: 0;
        transition: all 0.4s var(--spring);
        z-index: 999;
        pointer-events: none;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .toast.show {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }
      .toast.success {
        border-color: var(--green);
        box-shadow: 0 10px 30px rgba(16, 185, 129, 0.2);
        color: var(--green);
      }

      /* ── CONFETTI ── */
      #confettiCanvas {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        display: none;
      }

      /* ── RESPONSIVE ── */
      @media (max-width: 1100px) {
        .mistakes ul {
          grid-template-columns: 1fr;
        }
        .wc-bento-grid {
          grid-template-columns: 1fr;
        }
      }
      @media (max-width: 768px) {
        .layout {
          display: block;
          padding-bottom: 100px;
        } /* Leave room for floating nav */
        .sidebar,
        .right-sidebar {
          display: none;
        }
        .main {
          padding: 1.5rem 1rem;
        }
        .stats-row {
          grid-template-columns: 1fr 1fr;
        }
        .mobile-bot-nav {
          display: flex;
        }
        .hero-title {
          font-size: 2.2rem;
        }
      }
      @media (min-width: 769px) {
        .mobile-bot-nav {
          display: none;
        }
      }
      .mobile-bot-nav {
        position: fixed;
        bottom: max(
          24px,
          env(safe-area-inset-bottom)
        ); /* Floats above the bottom */
        left: 50%;
        transform: translateX(-50%);
        height: 64px;
        background: rgba(15, 17, 21, 0.85); /* Slightly darker glass */
        backdrop-filter: blur(24px);
        -webkit-backdrop-filter: blur(24px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 100px; /* Perfect pill shape */
        z-index: 200;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0 0.5rem;
        box-shadow:
          0 10px 30px rgba(0, 0, 0, 0.5),
          0 0 0 1px rgba(0, 0, 0, 0.8) inset;
        gap: 0.25rem;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s var(--spring);
      }
      .mobile-bot-nav.visible {
        opacity: 1;
        visibility: visible;
      }
      .mob-tab {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.6rem 1.2rem;
        border-radius: 100px;
        font-size: 0.85rem;
        font-weight: 700;
        color: var(--txt3);
        transition: all 0.3s var(--spring);
        cursor: pointer;
      }

      /* THE UX TRICK: Hide text unless it's active tab */
      .mob-tab span {
        display: none;
        white-space: nowrap;
      }
      .mob-tab.active span {
        display: block;
        animation: fadeIn 0.3s ease forwards;
      }

      .mob-tab.active {
        color: var(--txt);
        background: rgba(255, 255, 255, 0.08); /* Highlight pill */
        box-shadow: inset 0 1px 2px rgba(255, 255, 255, 0.1);
      }

      .mob-tab i {
        font-size: 1.5rem;
        transition: all 0.2s;
      }
      .mob-tab.active i {
        color: var(--blue);
        filter: drop-shadow(0 0 8px var(--blue-glow));
      }

      /* ── COMMAND PALETTE (Cmd+K) ── */
      .cmd-palette-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        z-index: 9999;
        display: none;
        align-items: flex-start;
        justify-content: center;
        padding-top: 15vh;
        opacity: 0;
        transition: opacity 0.2s ease;
      }
      .cmd-palette-overlay.open {
        display: flex;
        opacity: 1;
      }
      .cmd-modal {
        width: 90%;
        max-width: 600px;
        background: rgba(20, 22, 28, 0.85);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        box-shadow:
          0 30px 60px rgba(0, 0, 0, 0.5),
          0 0 0 1px inset rgba(255, 255, 255, 0.05);
        overflow: hidden;
        transform: scale(0.95) translateY(-20px);
        transition: transform 0.3s var(--spring);
      }
      .cmd-palette-overlay.open .cmd-modal {
        transform: scale(1) translateY(0);
      }
      .cmd-input-wrap {
        padding: 1.25rem 1.5rem;
        border-bottom: 1px solid var(--border);
        display: flex;
        align-items: center;
        gap: 1rem;
      }
      .cmd-input-wrap i {
        font-size: 1.5rem;
        color: var(--blue);
      }
      .cmd-input {
        width: 100%;
        background: transparent;
        border: none;
        color: var(--txt);
        font-size: 1.2rem;
        outline: none;
        font-family: inherit;
        font-weight: 500;
      }
      .cmd-input::placeholder {
        color: var(--txt3);
      }
      .cmd-list {
        max-height: 350px;
        overflow-y: auto;
        padding: 0.5rem;
      }
      .cmd-item {
        padding: 0.8rem 1rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        cursor: pointer;
        border-radius: var(--radius-sm);
        color: var(--txt2);
        transition: all 0.1s;
        font-weight: 500;
      }
      .cmd-item i {
        font-size: 1.2rem;
      }
      .cmd-item.selected,
      .cmd-item:hover {
        background: rgba(59, 130, 246, 0.15);
        color: var(--txt);
      }
      .cmd-item.selected i {
        color: var(--blue);
      }
      .cmd-shortcut {
        margin-left: auto;
        background: rgba(255, 255, 255, 0.05);
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        font-size: 0.7rem;
        font-family: "JetBrains Mono", monospace;
        border: 1px solid var(--glass-border);
        color: var(--txt3);
      }

      /* ── QUICK CAPTURE FAB ── */
      .quick-fab-container {
        position: fixed;
        bottom: max(100px, env(safe-area-inset-bottom) + 80px);
        right: 1.5rem;
        z-index: 150;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 0.5rem;
      }
      .quick-fab-menu {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        opacity: 0;
        pointer-events: none;
        transform: translateY(20px) scale(0.9);
        transition: all 0.3s var(--spring);
        transform-origin: bottom right;
      }
      .quick-fab-container.open .quick-fab-menu {
        opacity: 1;
        pointer-events: all;
        transform: translateY(0) scale(1);
      }
      .fab-action {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background: rgba(10, 12, 16, 0.95);
        border: 1px solid var(--glass-border);
        padding: 0.75rem 1rem;
        border-radius: 100px;
        color: var(--txt);
        font-weight: 600;
        font-size: 0.85rem;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        transition: all 0.2s;
      }
      .fab-action:hover {
        background: var(--glass-hover);
        border-color: var(--blue);
        color: var(--blue);
      }
      .fab-main {
        width: 56px;
        height: 56px;
        background: linear-gradient(135deg, var(--blue), var(--purple));
        border: none;
        border-radius: 50%;
        color: #fff;
        font-size: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        cursor: pointer;
        transition: transform 0.3s var(--spring);
      }
      .quick-fab-container.open .fab-main {
        transform: rotate(45deg);
        background: var(--bg);
        border: 1px solid var(--glass-border);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
      }

      /* ── PACE TRACKER NUDGE ── */
      .pace-nudge {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        background: rgba(245, 158, 11, 0.1);
        border: 1px solid rgba(245, 158, 11, 0.3);
        padding: 0.75rem 1rem;
        border-radius: var(--radius-sm);
        margin-bottom: 1rem;
        color: var(--gold);
        font-size: 0.85rem;
        font-weight: 600;
        animation: fadeIn 0.4s ease;
      }
      .pace-nudge.good {
        background: rgba(16, 185, 129, 0.1);
        border-color: rgba(16, 185, 129, 0.3);
        color: var(--green);
      }

      /* Checklist specialized */
      .w8-checklist {
        background: linear-gradient(
          145deg,
          rgba(245, 158, 11, 0.05),
          transparent
        );
        border: 1px solid rgba(245, 158, 11, 0.2);
        padding: 1.5rem;
        border-radius: var(--radius-md);
        margin-bottom: 1.5rem;
      }
      .w8-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1rem;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body>
    <nav class="topbar">
      <div class="topbar-logo">
        <i class="ph-fill ph-rocket-launch"></i> RN Roadmap
      </div>
      <div class="topbar-spacer"></div>
      <div class="topbar-actions">
        <div class="streak-badge">
          <i class="ph-fill ph-fire"></i> <span id="streakVal">0</span> days
        </div>
        <button
          class="mini-timer-btn icon-btn"
          id="miniTimerBtn"
          onclick="openTimer()"
          style="width: auto; padding: 0 1rem; border-radius: 20px"
        >
          <i class="ph-bold ph-timer"></i>
          <span id="miniTimerDisp" style="margin-left: 0.5rem">25:00</span>
        </button>
        <button class="icon-btn" onclick="openSettings()">
          <i class="ph-bold ph-gear"></i>
        </button>
      </div>
    </nav>

    <div class="layout">
      <aside class="sidebar" id="leftSidebar">
        <button class="sidebar-toggle-btn" onclick="toggleLeftSidebar()">
          <span class="sb-toggle-label">Collapse Menu</span>
          <i class="ph-bold ph-caret-double-left" id="sbLeftIcon"></i>
        </button>
        <div class="sidebar-label">Milestones</div>
        <div class="sidebar-item active" id="sideM1" onclick="scrollToId('m1')">
          <div class="sidebar-title">
            <i class="ph-fill ph-books sidebar-icon-only"></i
            ><span class="sb-text">Job Ready</span>
          </div>
          <div class="sidebar-sub">8 weeks</div>
          <div class="sidebar-pct" id="sideM1Pct">0%</div>
          <div class="sidebar-bar">
            <div
              class="sidebar-bar-fill"
              id="sideM1Bar"
              style="width: 0%; background: var(--blue)"
            ></div>
          </div>
        </div>
        <div class="sidebar-item m2" id="sideM2" onclick="scrollToId('m2')">
          <div class="sidebar-title">
            <i class="ph-fill ph-trophy sidebar-icon-only"></i
            ><span class="sb-text">Senior Solid</span>
          </div>
          <div class="sidebar-sub">4 months</div>
          <div class="sidebar-pct" id="sideM2Pct">0%</div>
          <div class="sidebar-bar">
            <div
              class="sidebar-bar-fill"
              id="sideM2Bar"
              style="width: 0%; background: var(--purple)"
            ></div>
          </div>
        </div>
        <div class="sidebar-item m3" id="sideM3" onclick="scrollToId('m3')">
          <div class="sidebar-title">
            <i class="ph-fill ph-star sidebar-icon-only"></i
            ><span class="sb-text">Staff Track</span>
          </div>
          <div class="sidebar-sub">6 months</div>
          <div class="sidebar-pct" id="sideM3Pct">0%</div>
          <div class="sidebar-bar">
            <div
              class="sidebar-bar-fill"
              id="sideM3Bar"
              style="width: 0%; background: var(--gold)"
            ></div>
          </div>
        </div>
      </aside>

      <main class="main" id="mainContent">
        <div class="hero">
          <h1 class="hero-title">React Native → Senior Engineer</h1>
          <p class="hero-sub">
            <i class="ph-bold ph-target"></i> 8 weeks to your first $120K+
            remote offer. Build proof, not just projects.
          </p>

          <div class="stats-row">
            <div class="stat-box glass-panel">
              <span class="stat-val" id="totalDone">0</span>
              <span class="stat-lbl">Tasks Done</span>
            </div>
            <div class="stat-box glass-panel">
              <span class="stat-val" id="streakDisp" style="color: var(--gold)"
                >0</span
              >
              <span class="stat-lbl">Day Streak</span>
            </div>
            <div class="stat-box glass-panel">
              <span class="stat-val" id="sessDisp" style="color: var(--green)"
                >0</span
              >
              <span class="stat-lbl">Focus Sessions</span>
            </div>
            <div class="stat-box glass-panel">
              <span class="stat-val" id="timeDisp" style="color: var(--purple)"
                >0h</span
              >
              <span class="stat-lbl">Time Invested</span>
            </div>
          </div>
        </div>

        <div class="focus-section glass-panel">
          <div class="focus-header">
            <i
              class="ph-fill ph-crosshair"
              style="font-size: 1.8rem; color: var(--blue)"
            ></i>
            <span class="focus-title">Daily Standup (Today's Focus)</span>
          </div>
          <div class="focus-list" id="todayFocus"></div>
        </div>

        <div class="milestone-section" id="m1">
          <div
            class="milestone-header glass-panel m1-header"
            onclick="toggleMilestone('m1')"
          >
            <div class="milestone-icon"><i class="ph-fill ph-books"></i></div>
            <div class="milestone-info">
              <div class="milestone-name">Milestone 1: Job Ready</div>
              <div class="milestone-sub">Weeks 1-8 · Target: $120K+ Offer</div>
            </div>
            <div class="milestone-prog">
              <div class="milestone-pct-text" id="m1Pct">0%</div>
              <div class="milestone-bar">
                <div
                  class="milestone-bar-fill"
                  id="m1Bar"
                  style="
                    width: 0%;
                    background: var(--blue);
                    box-shadow: 0 0 10px var(--blue-glow);
                  "
                ></div>
              </div>
            </div>
            <i
              class="ph-bold ph-caret-down milestone-toggle open"
              id="m1Toggle"
            ></i>
          </div>
          <div class="milestone-body open" id="m1Body">
            <div id="wc-w1"></div>
            <div id="wc-w2"></div>
            <div id="wc-w3"></div>
            <div id="wc-w4"></div>
            <div id="wc-w5"></div>
            <div id="wc-w6"></div>
            <div id="wc-w7"></div>
            <div id="wc-w8"></div>
          </div>
        </div>

        <div class="milestone-section" id="m2">
          <div
            class="milestone-header glass-panel m2-header"
            onclick="toggleMilestone('m2')"
          >
            <div class="milestone-icon"><i class="ph-fill ph-trophy"></i></div>
            <div class="milestone-info">
              <div class="milestone-name">Milestone 2: Senior Solid</div>
              <div class="milestone-sub">Months 3-6 · Post-hire growth</div>
            </div>
            <div class="milestone-prog">
              <div class="milestone-pct-text" id="m2Pct">0%</div>
              <div class="milestone-bar">
                <div
                  class="milestone-bar-fill"
                  id="m2Bar"
                  style="
                    width: 0%;
                    background: var(--purple);
                    box-shadow: 0 0 10px var(--purple-glow);
                  "
                ></div>
              </div>
            </div>
            <i class="ph-bold ph-caret-down milestone-toggle" id="m2Toggle"></i>
          </div>
          <div class="milestone-body" id="m2Body">
            <div
              id="m2Content"
              style="padding: 2rem; text-align: center; color: var(--txt3)"
            >
              Content loads here...
            </div>
          </div>
        </div>

        <div class="milestone-section" id="m3">
          <div
            class="milestone-header glass-panel m3-header"
            onclick="toggleMilestone('m3')"
          >
            <div class="milestone-icon"><i class="ph-fill ph-star"></i></div>
            <div class="milestone-info">
              <div class="milestone-name">Milestone 3: Staff Track</div>
              <div class="milestone-sub">Months 7-12 · Scale to $200K+</div>
            </div>
            <div class="milestone-prog">
              <div class="milestone-pct-text" id="m3Pct">0%</div>
              <div class="milestone-bar">
                <div
                  class="milestone-bar-fill"
                  id="m3Bar"
                  style="
                    width: 0%;
                    background: var(--gold);
                    box-shadow: 0 0 10px var(--gold-glow);
                  "
                ></div>
              </div>
            </div>
            <i class="ph-bold ph-caret-down milestone-toggle" id="m3Toggle"></i>
          </div>
          <div class="milestone-body" id="m3Body">
            <div
              id="m3Content"
              style="padding: 2rem; text-align: center; color: var(--txt3)"
            >
              Content loads here...
            </div>
          </div>
        </div>
      </main>

      <aside class="right-sidebar" id="rightSidebar">
        <button class="rside-toggle" onclick="toggleRightSidebar()">
          <span class="rside-toggle-label">Job Radar</span>
          <i class="ph-bold ph-caret-double-right" id="rsideIcon"></i>
        </button>

        <div class="jst-mini" id="jstMiniView">
          <div class="jst-mini-row">
            <span class="jst-mini-val" id="jstMiniApp">0</span
            ><span class="jst-mini-lbl">Apps</span>
          </div>
          <div class="jst-mini-row">
            <span
              class="jst-mini-val"
              style="color: var(--purple)"
              id="jstMiniInt"
              >0</span
            ><span class="jst-mini-lbl">Int</span>
          </div>
          <div class="jst-mini-row">
            <span
              class="jst-mini-val"
              style="color: var(--green)"
              id="jstMiniOff"
              >0</span
            ><span class="jst-mini-lbl">Off</span>
          </div>
        </div>

        <div
          class="jst-full glass-panel"
          style="
            border-radius: var(--radius-lg);
            background: rgba(20, 22, 28, 0.4);
          "
        >
          <div class="jst-title">
            <i class="ph-fill ph-radar"></i> Offer Radar
          </div>

          <div class="jst-metric">
            <div class="jst-label">
              Applications <span class="jst-target">Goal: 50</span>
            </div>
            <div class="jst-row">
              <input
                class="jst-input"
                type="number"
                min="0"
                id="jstApp"
                value="0"
                oninput="updateJST('applications', this.value)"
              />
              <div class="jst-bar">
                <div
                  class="jst-bar-fill"
                  id="jstAppBar"
                  style="width: 0%; box-shadow: 0 0 8px var(--blue-glow)"
                ></div>
              </div>
            </div>
          </div>

          <div class="jst-metric">
            <div class="jst-label">
              Interviews <span class="jst-target">Goal: 5</span>
            </div>
            <div class="jst-row">
              <input
                class="jst-input"
                type="number"
                min="0"
                id="jstInt"
                value="0"
                oninput="updateJST('interviews', this.value)"
              />
              <div class="jst-bar">
                <div
                  class="jst-bar-fill"
                  style="
                    background: var(--purple);
                    box-shadow: 0 0 8px var(--purple-glow);
                  "
                  id="jstIntBar"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>

          <div class="jst-metric">
            <div class="jst-label">
              Offers <span class="jst-target">Goal: 1</span>
            </div>
            <div class="jst-row">
              <input
                class="jst-input"
                type="number"
                min="0"
                id="jstOff"
                value="0"
                oninput="updateJST('offers', this.value)"
              />
              <div class="jst-bar">
                <div
                  class="jst-bar-fill"
                  style="
                    background: var(--green);
                    box-shadow: 0 0 8px var(--green-glow);
                  "
                  id="jstOffBar"
                  style="width: 0%"
                ></div>
              </div>
            </div>
          </div>

          <button class="jst-cta" onclick="applyThree()">
            <i class="ph-bold ph-paper-plane-tilt"></i> Log 3 Applications
          </button>
        </div>
      </aside>
    </div>

    <nav class="mobile-bot-nav">
      <div
        class="mob-tab active"
        onclick="
          scrollToId('m1')
          setMobActive(this)
        "
      >
        <i class="ph-fill ph-books"></i><span>Job Ready</span>
      </div>
      <div
        class="mob-tab"
        onclick="
          scrollToId('m2')
          setMobActive(this)
        "
      >
        <i class="ph-fill ph-trophy"></i><span>Senior</span>
      </div>
      <div
        class="mob-tab"
        onclick="
          scrollToId('m3')
          setMobActive(this)
        "
      >
        <i class="ph-fill ph-star"></i><span>Staff</span>
      </div>
    </nav>

    <div class="modal-overlay" id="timerModal">
      <div class="modal" style="text-align: center">
        <div class="modal-title" style="justify-content: center">
          <i class="ph-fill ph-hourglass-high" style="color: var(--blue)"></i>
          Deep Work Timer
        </div>
        <div class="timer-display">
          <div class="timer-time" id="timerDisplayLg">25:00</div>
        </div>
        <div class="timer-controls">
          <button
            class="btn-primary"
            id="timerStartBtn"
            onclick="toggleTimer()"
          >
            Start Focus
          </button>
          <button class="btn-secondary" onclick="resetTimer()">
            <i class="ph-bold ph-arrow-counter-clockwise"></i>
          </button>
          <button class="btn-secondary" onclick="closeTimer()">
            <i class="ph-bold ph-x"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="noteModal">
      <div class="modal">
        <div class="modal-title" id="noteTaskTitle">
          <i class="ph-fill ph-note-pencil"></i> Notes
        </div>
        <textarea
          class="modal-textarea"
          id="noteText"
          placeholder="Jot down key takeaways, bugs faced, or commands to remember..."
        ></textarea>
        <div class="modal-actions">
          <button class="btn-secondary" onclick="closeNote()">Cancel</button>
          <button class="btn-primary" onclick="saveNote()">Save Note</button>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="settingsModal">
      <div class="modal">
        <div class="modal-title">
          <i class="ph-fill ph-gear"></i> Data & Settings
        </div>
        <div style="display: flex; flex-direction: column; gap: 1rem">
          <button class="btn-secondary" onclick="exportData()">
            <i class="ph-bold ph-download-simple"></i> Export Backup (JSON)
          </button>
          <button
            class="btn-secondary"
            onclick="document.getElementById('importInput').click()"
          >
            <i class="ph-bold ph-upload-simple"></i> Import Backup
          </button>
          <button
            class="btn-secondary"
            style="color: var(--red); border-color: var(--red)"
            onclick="confirmReset()"
          >
            <i class="ph-bold ph-trash"></i> Reset All Progress
          </button>
        </div>
        <div class="modal-actions">
          <button class="btn-primary" onclick="closeSettings()">Close</button>
        </div>
      </div>
    </div>

    <div
      class="cmd-palette-overlay"
      id="cmdPalette"
      onclick="if (event.target === this) closeCmd()"
    >
      <div class="cmd-modal">
        <div class="cmd-input-wrap">
          <i class="ph-bold ph-magnifying-glass"></i>
          <input
            type="text"
            class="cmd-input"
            id="cmdInput"
            placeholder="Type a command or search..."
            autocomplete="off"
          />
        </div>
        <div class="cmd-list" id="cmdList"></div>
      </div>
    </div>

    <div class="quick-fab-container" id="quickFab">
      <div class="quick-fab-menu">
        <button
          class="fab-action"
          onclick="
            applyThree()
            toggleFab()
          "
        >
          <i class="ph-bold ph-paper-plane-tilt"></i> Log 3 Job Apps
        </button>
        <button
          class="fab-action"
          onclick="
            openTimer()
            toggleFab()
          "
        >
          <i class="ph-bold ph-timer"></i> Start Deep Work
        </button>
        <button
          class="fab-action"
          onclick="
            openSettings()
            toggleFab()
          "
        >
          <i class="ph-bold ph-calendar-plus"></i> Set Start Date
        </button>
      </div>
      <button class="fab-main" onclick="toggleFab()">
        <i class="ph-bold ph-plus"></i>
      </button>
    </div>

    <div class="toast" id="toast">
      <i class="ph-bold ph-check-circle"></i> <span id="toastMsg">Success</span>
    </div>
    <canvas id="confettiCanvas"></canvas>

    <script>
      // --- DATA: MILESTONE 1 (Job Ready) ---
      const M1_WEEKS = [
        {
          id: "w1",
          num: "WEEK 01",
          title: "PostgreSQL + Zonesso Migration",
          subtitle: "From MongoDB to relational thinking",
          color: "var(--w1)",
          interviewQ:
            "Design Uber's database schema for drivers, riders, trips, payments",
          deliverable: "GitHub: zonesso-postgresql with Railway live URL",
          mistakes: [
            "Using ORM before writing raw SQL",
            "Skipping EXPLAIN ANALYZE",
            "Not indexing foreign keys",
          ],
          tasks: [
            {
              t: "Audit Zonesso MongoDB schema",
              time: "30m",
              why: "Documenting current state prevents migration disasters",
            },
            {
              t: "Design PostgreSQL schema with relations",
              time: "1h",
              why: "Foreign keys enforce data integrity",
            },
            {
              t: "Write migration script Node.js",
              time: "2h",
              why: "Real migrations show production thinking",
            },
            {
              t: "Build NestJS + Prisma API",
              time: "1.5h",
              why: "Prisma is the 2026 standard for TS backends",
              links: [{ url: "#", tag: "Docs", type: "docs" }],
            },
            {
              t: "Add transactions for chat safety",
              time: "1h",
              why: "ACID prevents bugs in production",
            },
            {
              t: "Write migration case study blog",
              time: "1h",
              why: "Public writing = recruiter visibility",
            },
            {
              t: "Deploy to Railway + update resume",
              time: "1h",
              why: "Live URLs get 3x more callbacks",
            },
          ],
        },
        {
          id: "w2",
          num: "WEEK 02",
          title: "Production API + Profile Opt.",
          subtitle: "JWT auth, testing, LinkedIn",
          color: "var(--w2)",
          interviewQ: "Explain ACID properties and performance tradeoffs",
          deliverable: "Optimized LinkedIn + resume with metrics",
          mistakes: [
            "Generic resume without metrics",
            'Headline "React Native Developer"',
            "Waiting to apply",
          ],
          tasks: [
            {
              t: "Add indexing for Zonesso queries",
              time: "1h",
              why: "Slow queries kill user experience",
            },
            {
              t: "Implement GraphQL/tRPC API",
              time: "1.5h",
              why: "Modern API expectations for 2026",
            },
            {
              t: "Write Jest tests for critical paths",
              time: "1.5h",
              why: "No tests = no production code",
            },
            {
              t: "Rewrite resume with STAR + metrics",
              time: "2h",
              why: "Metrics prove impact (e.g., 50K users)",
            },
            {
              t: "Optimize LinkedIn headline",
              time: "1h",
              why: "SEO for recruiters",
            },
            {
              t: "Apply to 10 jobs",
              time: "1.5h",
              why: "Volume beats perfection",
            },
          ],
        },
        {
          id: "w3",
          num: "WEEK 03",
          title: "AI Integration + JIFFL",
          subtitle: "Ship AI features users actually use",
          color: "var(--w3)",
          interviewQ: "Add AI to existing app without breaking the bank",
          deliverable: "JIFFL with AI matching + screen recording",
          mistakes: [
            "Calling OpenAI from mobile client directly",
            "No rate limiting",
            "Not caching responses",
          ],
          tasks: [
            {
              t: "OpenAI API with streaming SSE",
              time: "1.5h",
              why: "Streaming feels instant",
            },
            {
              t: "Build AI job matching with embeddings",
              time: "1.5h",
              why: "Semantic search > keyword matching",
            },
            {
              t: "Add rate limiting + cost alerts",
              time: "1h",
              why: "Set a $50 hard limit",
            },
            {
              t: "Screen record demo, post LinkedIn",
              time: "1h",
              why: "Visual proof attracts leads",
            },
            {
              t: "Apply to 10 more jobs",
              time: "1.5h",
              why: "Keep momentum going",
            },
            {
              t: "Follow up on Week 2 apps",
              time: "30m",
              why: "20% higher response rate",
            },
          ],
        },
        {
          id: "w4",
          num: "WEEK 04",
          title: "AI at Scale + App Blitz",
          subtitle: "Embeddings, semantic search, 30 apps",
          color: "var(--w4)",
          interviewQ: "Design a rate limiter for an AI API",
          deliverable: "Smart matching with RAG + pgvector",
          mistakes: [
            "Microservices too early",
            "No retry logic",
            "Ignoring token costs",
          ],
          tasks: [
            {
              t: "Add pgvector extension to PostgreSQL",
              time: "1.5h",
              why: "Native vector search",
            },
            {
              t: "Implement semantic search for jobs",
              time: "1.5h",
              why: "Find jobs by intent",
            },
            {
              t: "Build RAG: search docs before AI call",
              time: "1.5h",
              why: "Reduce hallucinations",
            },
            {
              t: "Apply to 10 more jobs",
              time: "1.5h",
              why: "Reach 30 total applications",
            },
            {
              t: "Do 1 mock technical screen",
              time: "1h",
              why: "Practice makes perfect",
            },
          ],
        },
        {
          id: "w5",
          num: "WEEK 05",
          title: "AWS Foundations + Eco Crew",
          subtitle: "Deploy to production AWS",
          color: "var(--w5)",
          interviewQ: "Deploy a Node.js app with zero downtime",
          deliverable: "Dockerized Eco Crew on EC2 + RDS",
          mistakes: [
            "DB on EC2 instead of RDS",
            "Root AWS credentials",
            "No alarms",
          ],
          tasks: [
            {
              t: "Dockerize Eco Crew backend",
              time: "1.5h",
              why: "Standardize environments",
            },
            {
              t: "AWS EC2 + RDS PostgreSQL setup",
              time: "1.5h",
              why: "Managed scaling",
            },
            {
              t: "S3 for images + CloudFront CDN",
              time: "1.5h",
              why: "Fast global delivery",
            },
            {
              t: "GitHub Actions CI/CD pipeline",
              time: "1.5h",
              why: "Automated deploys",
            },
            {
              t: "Apply to 10 more jobs",
              time: "1.5h",
              why: "Reach 40 total applications",
            },
          ],
        },
        {
          id: "w6",
          num: "WEEK 06",
          title: "AWS Mobile + Interview Prep",
          subtitle: "Amplify, CI/CD, and mocks",
          color: "var(--w6)",
          interviewQ: "Set up CI/CD for a mobile team",
          deliverable: "Full pipeline + 3 mock interviews",
          mistakes: [
            "Manual deployments",
            "No staging environment",
            "Secrets in code",
          ],
          tasks: [
            {
              t: "SNS push notifications cross-platform",
              time: "1.5h",
              why: "Unified push API",
            },
            {
              t: "CloudWatch monitoring + alerts",
              time: "1h",
              why: "Fix what you can see",
            },
            {
              t: "Mock interview: System design",
              time: "1h",
              why: "Practice reduces anxiety",
            },
            {
              t: "Mock interview: React Native deep dive",
              time: "1h",
              why: "Know your stack cold",
            },
            { t: "Apply to 5 more jobs", time: "1h", why: "Reach 45 total" },
          ],
        },
        {
          id: "w7",
          num: "WEEK 07",
          title: "System Design + RN Arch",
          subtitle: "Design at scale, New Architecture",
          color: "var(--w7)",
          interviewQ: "Design WhatsApp for 1 billion users",
          deliverable: "Excalidraw diagrams + RN New Arch",
          mistakes: [
            "Premature optimization",
            "Ignoring offline mode",
            "Battery drain issues",
          ],
          tasks: [
            {
              t: "Document Zonesso architecture (Excalidraw)",
              time: "1.5h",
              why: "Visual communication skill",
            },
            {
              t: "Design WhatsApp chat at scale",
              time: "1.5h",
              why: "Classic interview question",
            },
            {
              t: "React Native New Architecture deep dive",
              time: "1.5h",
              why: "Fabric/JSI required for 2026",
            },
            {
              t: "Performance profiling with Flipper",
              time: "1.5h",
              why: "Proactive optimization",
            },
            { t: "Final 5 applications", time: "1h", why: "Hit the 50 target" },
          ],
        },
        {
          id: "w8",
          num: "WEEK 08",
          title: "Offer Negotiation",
          subtitle: "Deploy your career to production",
          color: "var(--w8)",
          interviewQ: "Design a payment processing system",
          deliverable: "$130K+ offer accepted",
          mistakes: [
            "Accepting first offer",
            "No competing offers",
            "Ignoring total comp",
          ],
          tasks: [
            {
              t: "Final mock interviews (record & watch)",
              time: "2h",
              why: "Fix filler words",
            },
            {
              t: "Research salary bands on levels.fyi",
              time: "1h",
              why: "Data wins negotiations",
            },
            {
              t: "Draft negotiation script (ask +15K)",
              time: "1h",
              why: "Always counter-offer",
            },
            {
              t: "Evaluate and accept best offer",
              time: "30m",
              why: "Consider tech stack & culture",
            },
          ],
        },
      ]

      const W8_CHECKLIST = [
        { id: "w8c1", text: "50 job applications sent" },
        { id: "w8c2", text: "GitHub: zonesso-postgresql live" },
        { id: "w8c3", text: "GitHub: jiffl-ai-matching live" },
        { id: "w8c4", text: "AWS Cloud Practitioner cert" },
        { id: "w8c5", text: "Resume updated with metrics" },
        { id: "w8c6", text: "Offer negotiated to target" },
      ]

      // --- STATE MANAGEMENT ---
      const SKEY = "rn_roadmap_v2026"
      let S

      function defaultState() {
        return {
          tasks: {},
          notes: {},
          weeksCollapsed: {},
          jobSearch: { applications: 0, interviews: 0, offers: 0 },
          timerSecs: 1500,
          streak: 0,
          lastDate: null,
          sessions: 0,
        }
      }

      function loadState() {
        try {
          const raw = localStorage.getItem(SKEY)
          if (raw) {
            S = { ...defaultState(), ...JSON.parse(raw) }
            return
          }
        } catch (e) {}
        S = defaultState()
      }
      function save() {
        localStorage.setItem(SKEY, JSON.stringify(S))
      }

      // --- RENDER LOGIC ---
      function renderM1() {
        M1_WEEKS.forEach((w) => {
          const el = document.getElementById("wc-" + w.id)
          if (!el) return

          const tasksHtml = w.tasks
            .map((t, i) => {
              const key = w.id + "_" + i
              const done = S.tasks[key]
              const hasNote = S.notes[key] && S.notes[key].trim() !== ""
              return `
        <div class="task-item ${done ? "done" : ""}" onclick="toggleTask('${key}', this)">
          <div class="task-cb ${done ? "checked" : ""}"><i class="ph-bold ph-check"></i></div>
          <div class="task-content">
            <div class="task-text">${t.t}</div>
            <div class="task-meta">
              <span class="task-time"><i class="ph-bold ph-clock"></i> ${t.time}</span>
              <span class="task-why" title="${t.why}">Why?</span>
              <button class="task-note-btn ${hasNote ? "has-note" : ""}" onclick="openNote('${key}', '${t.t.replace(/'/g, "\\'")}', event)"><i class="ph-bold ph-chat-text"></i></button>
            </div>
          </div>
        </div>
      `
            })
            .join("")

          const mistakesHtml = w.mistakes
            .map(
              (m) => `<li><i class="ph-bold ph-x"></i> <span>${m}</span></li>`,
            )
            .join("")

          // Calculate progress
          const doneCount = w.tasks.filter(
            (_, i) => S.tasks[w.id + "_" + i],
          ).length
          const pct = Math.round((doneCount / w.tasks.length) * 100)
          const collapsed = S.weeksCollapsed[w.id]

          el.innerHTML = `
      <div class="week-card glass-panel">
        <div class="week-card-top" style="background:${w.color}; box-shadow: 0 0 15px ${w.color}; opacity: 0.8;"></div>
        <div class="wc-header" onclick="toggleWeek('${w.id}')">
          <div class="wc-left">
            <div class="wc-num" style="color:${w.color}"><i class="ph-bold ph-calendar-blank"></i> ${w.num}</div>
            <div class="wc-title">${w.title}</div>
            <div class="wc-subtitle">${w.subtitle}</div>
          </div>
          <div class="wc-right">
            <div class="wc-prog-row">
              <div class="wc-prog-bar"><div class="wc-prog-fill" style="width:${pct}%;background:${w.color}"></div></div>
              <span class="wc-pct">${pct}%</span>
            </div>
            <i class="ph-bold ph-caret-down wc-arrow ${collapsed ? "" : "open"}"></i>
          </div>
        </div>
        <div class="wc-body ${collapsed ? "hidden" : ""}">
          <div class="wc-body-inner">
            <div class="wc-bento-grid">
              <div class="info-box interview">
                <div class="box-title"><i class="ph-fill ph-chat-circle-text"></i> Interview Question</div>
                <div class="box-text">${w.interviewQ}</div>
              </div>
              <div class="info-box deliverable">
                <div class="box-title"><i class="ph-fill ph-target"></i> Deliverable</div>
                <div class="box-text">${w.deliverable}</div>
              </div>
              <div class="info-box mistakes">
                <div class="box-title"><i class="ph-fill ph-warning-circle"></i> Common Mistakes</div>
                <ul>${mistakesHtml}</ul>
              </div>
            </div>
            <div class="task-list">${tasksHtml}</div>
            ${w.id === "w8" ? renderChecklist() : ""}
          </div>
        </div>
      </div>
    `
        })
      }

      function renderChecklist() {
        const items = W8_CHECKLIST.map((c) => {
          const done = S.tasks[c.id]
          return `
      <div class="task-item ${done ? "done" : ""}" style="padding: 0.75rem 1rem;" onclick="toggleTask('${c.id}', this)">
        <div class="task-cb ${done ? "checked" : ""}"><i class="ph-bold ph-check"></i></div>
        <span class="task-text" style="margin:0; font-size:0.85rem;">${c.text}</span>
      </div>
    `
        }).join("")
        return `<div class="w8-checklist"><div class="box-title" style="color:var(--gold); margin-bottom:1rem;"><i class="ph-fill ph-flag-checkered"></i> Final Checklist</div><div class="w8-grid">${items}</div></div>`
      }

      function renderFocus() {
        const el = document.getElementById("todayFocus")
        let items = []

        // ---> ADD THIS LINE <---
        const paceNudgeHtml = getPaceNudge()

        M1_WEEKS.forEach((w) => {
          w.tasks.forEach((t, i) => {
            const key = w.id + "_" + i
            if (!S.tasks[key]) items.push({ key: key, text: t.t, num: w.num })
          })
        })

        if (items.length === 0) {
          el.innerHTML =
            paceNudgeHtml +
            '<div class="focus-empty"><i class="ph-fill ph-party" style="font-size: 2.5rem; margin-bottom: 0.5rem;"></i><span>All caught up! Excellent work.</span></div>'
        } else {
          const listHtml = items
            .slice(0, 4)
            .map(
              (i, index) => `
            <div class="focus-item" style="cursor: pointer; ${index === 0 ? "border-left: 3px solid var(--blue); background: rgba(59,130,246,0.1);" : ""}" onclick="toggleTask('${i.key}', this)">
              <div class="task-cb" style="width:20px; height:20px; border-radius:6px; pointer-events:none;"></div>
              <span style="flex:1; font-weight: ${index === 0 ? "700" : "500"};">${i.text}</span>
              <span style="color:var(--blue); font-size:0.75rem; font-family:'JetBrains Mono'; background: rgba(59,130,246,0.1); padding: 2px 6px; border-radius: 4px;">${i.num}</span>
            </div>
          `,
            )
            .join("")

          // ---> UPDATE THIS LINE to include paceNudgeHtml <---
          el.innerHTML = paceNudgeHtml + listHtml
        }
      }

      // --- INTERACTIVITY ---
      function toggleTask(key, el) {
        S.tasks[key] = !S.tasks[key]
        save()
        updateStats()
        renderM1()
        renderFocus()

        if (S.tasks[key]) {
          shootConfetti()
          toast("Task Complete!")
          // Haptic simulation
          if (navigator.vibrate) navigator.vibrate(40)
        }
      }

      function toggleWeek(id) {
        S.weeksCollapsed[id] = !S.weeksCollapsed[id]
        save()
        renderM1()
      }

      function toggleMilestone(id) {
        const body = document.getElementById(id + "Body")
        const toggle = document.getElementById(id + "Toggle")
        const isOpen = body.classList.contains("open")

        if (isOpen) {
          body.classList.remove("open")
          toggle.classList.remove("open")
        } else {
          body.classList.add("open")
          toggle.classList.add("open")
        }
      }

      // Add this variable at the top of your scripts
      let isAutoScrolling = false
      let lastScrollY = 0
      let ticking = false

      function scrollToId(id) {
        isAutoScrolling = true // Tell the app we are clicking, not user-scrolling

        document
          .getElementById(id)
          .scrollIntoView({ behavior: "smooth", block: "start" })

        // Set the clicked tab to active immediately
        document
          .querySelectorAll(".mob-tab")
          .forEach((t) => t.classList.remove("active"))
        document
          .querySelectorAll(".sidebar-item")
          .forEach((t) => t.classList.remove("active"))

        // Highlight the correct ones
        if (id === "m1") {
          document.getElementById("sideM1").classList.add("active")
          document.querySelectorAll(".mob-tab")[0].classList.add("active")
        } else if (id === "m2") {
          document.getElementById("sideM2").classList.add("active")
          document.querySelectorAll(".mob-tab")[1].classList.add("active")
        } else if (id === "m3") {
          document.getElementById("sideM3").classList.add("active")
          document.querySelectorAll(".mob-tab")[2].classList.add("active")
        }

        // Open milestone if collapsed
        if ((id === "m2" || id === "m3") && S.milestones_collapsed[id])
          toggleMilestone(id)

        // Turn scroll listener back on after animation finishes (800ms)
        setTimeout(() => {
          isAutoScrolling = false
        }, 800)
      }

      function updateSidebarActive() {
        // If the user clicked a tab, ignore standard scroll tracking until it finishes
        if (isAutoScrolling) return

        const sections = ["m1", "m2", "m3"]
        const centers = sections.map((id) => {
          const el = document.getElementById(id)
          if (!el) return 9999
          const r = el.getBoundingClientRect()
          return Math.abs(r.top - 150) // Check what is closest to top of screen
        })

        const idx = centers.indexOf(Math.min(...centers))

        // Update desktop sidebar
        ;["sideM1", "sideM2", "sideM3"].forEach((id, i) => {
          const el = document.getElementById(id)
          if (!el) return
          el.classList.toggle("active", i === idx)
        })

        // Update mobile bottom nav
        const mobTabs = document.querySelectorAll(".mob-tab:not(:last-child)") // Exclude timer
        mobTabs.forEach((tab, i) => {
          tab.classList.toggle("active", i === idx)
        })
      }

      function setMobActive(element) {
        document
          .querySelectorAll(".mob-tab")
          .forEach((tab) => tab.classList.remove("active"))
        element.classList.add("active")
      }

      function handleScroll() {
        lastScrollY = window.scrollY

        if (!ticking) {
          window.requestAnimationFrame(() => {
            const mobileNav = document.querySelector(".mobile-bot-nav")
            if (mobileNav) {
              // Show nav when scrolling down, hide when at top
              if (lastScrollY > 100) {
                mobileNav.classList.add("visible")
              } else {
                mobileNav.classList.remove("visible")
              }
            }
            ticking = false
          })

          ticking = true
        }
      }

      function updateJST(field, val) {
        S.jobSearch[field] = parseInt(val) || 0
        save()
        syncJST()
      }

      function applyThree() {
        S.jobSearch.applications += 3
        save()
        syncJST()
        toast("+3 Applications Logged!")
        shootConfetti()
      }

      function syncJST() {
        const js = S.jobSearch
        // Full
        const eApp = document.getElementById("jstApp")
        if (eApp && document.activeElement !== eApp)
          eApp.value = js.applications
        const eInt = document.getElementById("jstInt")
        if (eInt && document.activeElement !== eInt) eInt.value = js.interviews
        const eOff = document.getElementById("jstOff")
        if (eOff && document.activeElement !== eOff) eOff.value = js.offers

        document.getElementById("jstAppBar").style.width =
          Math.min((js.applications / 50) * 100, 100) + "%"
        document.getElementById("jstIntBar").style.width =
          Math.min((js.interviews / 5) * 100, 100) + "%"
        document.getElementById("jstOffBar").style.width =
          Math.min((js.offers / 1) * 100, 100) + "%"

        // Mini
        document.getElementById("jstMiniApp").textContent = js.applications
        document.getElementById("jstMiniInt").textContent = js.interviews
        document.getElementById("jstMiniOff").textContent = js.offers
      }

      function updateStats() {
        const done = Object.values(S.tasks).filter(Boolean).length
        document.getElementById("totalDone").textContent = done

        const m1Total = M1_WEEKS.reduce((a, w) => a + w.tasks.length, 0)
        const m1Done = M1_WEEKS.reduce(
          (a, w) =>
            a + w.tasks.filter((_, i) => S.tasks[w.id + "_" + i]).length,
          0,
        )
        const pct = Math.round((m1Done / m1Total) * 100)

        document.getElementById("m1Pct").textContent = pct + "%"
        document.getElementById("m1Bar").style.width = pct + "%"
        document.getElementById("sideM1Pct").textContent = pct + "%"
        document.getElementById("sideM1Bar").style.width = pct + "%"
      }

      // --- SIDEBAR TOGGLES ---
      let leftCollapsed = false
      let rightCollapsed = false

      function toggleLeftSidebar() {
        leftCollapsed = !leftCollapsed
        document
          .getElementById("leftSidebar")
          .classList.toggle("collapsed", leftCollapsed)
        document.querySelector(".layout").classList.toggle("lc", leftCollapsed)
        document.getElementById("sbLeftIcon").className = leftCollapsed
          ? "ph-bold ph-caret-double-right"
          : "ph-bold ph-caret-double-left"
      }

      function toggleRightSidebar() {
        rightCollapsed = !rightCollapsed
        document
          .getElementById("rightSidebar")
          .classList.toggle("collapsed", rightCollapsed)
        document.querySelector(".layout").classList.toggle("rc", rightCollapsed)
        document.getElementById("rsideIcon").className = rightCollapsed
          ? "ph-bold ph-caret-double-left"
          : "ph-bold ph-caret-double-right"
      }

      // --- MODALS & TIMER ---
      let timerInt
      let isRunning = false

      function openTimer() {
        document.getElementById("timerModal").classList.add("open")
      }
      function closeTimer() {
        document.getElementById("timerModal").classList.remove("open")
      }
      function openSettings() {
        document.getElementById("settingsModal").classList.add("open")
      }
      function closeSettings() {
        document.getElementById("settingsModal").classList.remove("open")
      }

      function fmtTimer(s) {
        return `${String(Math.floor(s / 60)).padStart(2, "0")}:${String(s % 60).padStart(2, "0")}`
      }

      function renderTimerUI() {
        const t = fmtTimer(S.timerSecs)
        document.getElementById("timerDisplayLg").textContent = t
        document.getElementById("miniTimerDisp").textContent = t
        document
          .getElementById("miniTimerBtn")
          .classList.toggle("running", isRunning)
      }

      function toggleTimer() {
        if (isRunning) {
          clearInterval(timerInt)
          isRunning = false
          document.getElementById("timerStartBtn").innerHTML =
            '<i class="ph-bold ph-play"></i> Resume Focus'
          document.body.classList.remove("focus-mode")
        } else {
          isRunning = true
          document.getElementById("timerStartBtn").innerHTML =
            '<i class="ph-bold ph-pause"></i> Pause'
          document.body.classList.add("focus-mode")
          timerInt = setInterval(() => {
            S.timerSecs--
            if (S.timerSecs <= 0) {
              clearInterval(timerInt)
              isRunning = false
              S.timerSecs = 1500
              S.sessions++
              document.getElementById("sessDisp").textContent = S.sessions
              document.getElementById("timeDisp").textContent =
                Math.round((S.sessions * 25) / 60) + "h"
              document.body.classList.remove("focus-mode")
              toast("Session Complete!", "success")
              shootConfetti()
              save()
            }
            renderTimerUI()
          }, 1000)
        }
        renderTimerUI()
      }

      function resetTimer() {
        clearInterval(timerInt)
        isRunning = false
        S.timerSecs = 1500
        document.body.classList.remove("focus-mode")
        document.getElementById("timerStartBtn").innerHTML = "Start Focus"
        renderTimerUI()
      }

      // --- NOTES ---
      let activeNote = null
      function openNote(key, title, e) {
        e.stopPropagation()
        activeNote = key
        document.getElementById("noteTaskTitle").innerHTML =
          `<i class="ph-fill ph-note-pencil"></i> Notes: ${title}`
        document.getElementById("noteText").value = S.notes[key] || ""
        document.getElementById("noteModal").classList.add("open")
      }
      function closeNote() {
        document.getElementById("noteModal").classList.remove("open")
      }
      function saveNote() {
        const val = document.getElementById("noteText").value.trim()
        if (val) S.notes[activeNote] = val
        else delete S.notes[activeNote]
        save()
        closeNote()
        renderM1()
        toast("Note saved")
      }

      // --- UTILS ---
      function toast(msg, type = "success") {
        const el = document.getElementById("toast")
        document.getElementById("toastMsg").textContent = msg
        el.className = "toast show " + type
        setTimeout(() => el.classList.remove("show"), 3000)
      }

      function shootConfetti() {
        const canvas = document.getElementById("confettiCanvas")
        canvas.style.display = "block"
        const ctx = canvas.getContext("2d")
        canvas.width = window.innerWidth
        canvas.height = window.innerHeight
        const particles = Array.from({ length: 80 }, () => ({
          x: Math.random() * canvas.width,
          y: -20,
          vx: (Math.random() - 0.5) * 8,
          vy: Math.random() * 5 + 2,
          color: ["#3b82f6", "#10b981", "#f59e0b", "#8b5cf6"][
            Math.floor(Math.random() * 4)
          ],
          size: Math.random() * 8 + 4,
          life: 1,
          rot: Math.random() * 360,
        }))
        function draw() {
          ctx.clearRect(0, 0, canvas.width, canvas.height)
          let alive = false
          particles.forEach((p) => {
            p.x += p.vx
            p.y += p.vy
            p.vy += 0.2
            p.life -= 0.01
            p.rot += 5
            if (p.life > 0 && p.y < canvas.height) alive = true
            ctx.save()
            ctx.globalAlpha = Math.max(0, p.life)
            ctx.translate(p.x, p.y)
            ctx.rotate((p.rot * Math.PI) / 180)
            ctx.fillStyle = p.color
            ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size)
            ctx.restore()
          })
          if (alive) requestAnimationFrame(draw)
          else canvas.style.display = "none"
        }
        draw()
      }

      function exportData() {
        const blob = new Blob([JSON.stringify(S)], { type: "application/json" })
        const a = document.createElement("a")
        a.href = URL.createObjectURL(blob)
        a.download = "rn-roadmap-backup.json"
        a.click()
      }

      function confirmReset() {
        if (confirm("Erase all progress? This action cannot be undone.")) {
          S = defaultState()
          save()
          location.reload()
        }
      }

      // ═════════════════════════════════════════════════
      //  QUICK CAPTURE FAB
      // ═════════════════════════════════════════════════
      function toggleFab() {
        document.getElementById("quickFab").classList.toggle("open")
      }

      // ═════════════════════════════════════════════════
      //  COMMAND PALETTE (Cmd+K)
      // ═════════════════════════════════════════════════
      const COMMANDS = [
        {
          icon: "ph-timer",
          text: "Start Focus Timer",
          action: () => {
            openTimer()
            toggleTimer()
          },
        },
        {
          icon: "ph-paper-plane-tilt",
          text: "Log 3 Job Applications",
          action: () => applyThree(),
        },
        {
          icon: "ph-books",
          text: "Go to Milestone 1 (Job Ready)",
          action: () => scrollToId("m1"),
        },
        {
          icon: "ph-trophy",
          text: "Go to Milestone 2 (Senior Solid)",
          action: () => scrollToId("m2"),
        },
        {
          icon: "ph-download-simple",
          text: "Export Backup Data",
          action: () => exportData(),
        },
        {
          icon: "ph-gear",
          text: "Open Settings / Start Date",
          action: () => openSettings(),
        },
      ]

      let cmdSelectedIndex = 0

      function openCmd() {
        document.getElementById("cmdPalette").classList.add("open")
        document.getElementById("cmdInput").value = ""
        renderCmdList("")
        setTimeout(() => document.getElementById("cmdInput").focus(), 100)
      }

      function closeCmd() {
        document.getElementById("cmdPalette").classList.remove("open")
      }

      function renderCmdList(query) {
        const list = document.getElementById("cmdList")
        const filtered = COMMANDS.filter((c) =>
          c.text.toLowerCase().includes(query.toLowerCase()),
        )

        if (filtered.length === 0) {
          list.innerHTML = `<div style="padding: 2rem; text-align: center; color: var(--txt3);">No commands found</div>`
          return
        }

        // Ensure selection doesn't go out of bounds
        cmdSelectedIndex = Math.min(cmdSelectedIndex, filtered.length - 1)

        list.innerHTML = filtered
          .map(
            (c, i) => `
    <div class="cmd-item ${i === cmdSelectedIndex ? "selected" : ""}" onclick="executeCmd(${i})">
      <i class="ph-bold ${c.icon}"></i>
      <span>${c.text}</span>
      ${i === 0 && !query ? '<span class="cmd-shortcut">Enter</span>' : ""}
    </div>
  `,
          )
          .join("")

        // Store currently filtered commands for keyboard execution
        window.currentFilteredCmds = filtered
      }

      function executeCmd(index) {
        if (window.currentFilteredCmds && window.currentFilteredCmds[index]) {
          closeCmd()
          window.currentFilteredCmds[index].action()
        }
      }

      document.getElementById("cmdInput")?.addEventListener("input", (e) => {
        cmdSelectedIndex = 0
        renderCmdList(e.target.value)
      })

      // Keyboard Listeners
      document.addEventListener("keydown", (e) => {
        // Cmd+K or Ctrl+K to open
        if ((e.metaKey || e.ctrlKey) && e.key === "k") {
          e.preventDefault()
          openCmd()
        }

        const isCmdOpen = document
          .getElementById("cmdPalette")
          .classList.contains("open")
        if (!isCmdOpen) return

        if (e.key === "Escape") closeCmd()
        if (e.key === "ArrowDown") {
          e.preventDefault()
          cmdSelectedIndex = Math.min(
            cmdSelectedIndex + 1,
            window.currentFilteredCmds.length - 1,
          )
          renderCmdList(document.getElementById("cmdInput").value)
        }
        if (e.key === "ArrowUp") {
          e.preventDefault()
          cmdSelectedIndex = Math.max(cmdSelectedIndex - 1, 0)
          renderCmdList(document.getElementById("cmdInput").value)
        }
        if (e.key === "Enter") {
          e.preventDefault()
          executeCmd(cmdSelectedIndex)
        }
      })

      // ═════════════════════════════════════════════════
      //  INTELLIGENT PACE TRACKER
      // ═════════════════════════════════════════════════
      // Call this function inside your renderFocus() function at the top!
      function getPaceNudge() {
        if (!S.startDate)
          return `<div class="pace-nudge"><i class="ph-fill ph-warning"></i> Set a Start Date in Settings to track your 8-week pace!</div>`

        const start = new Date(S.startDate)
        const now = new Date()
        const daysPassed = Math.floor((now - start) / (1000 * 60 * 60 * 24))

        if (daysPassed < 0) return "" // Hasn't started yet

        const expectedWeek = Math.floor(daysPassed / 7) + 1

        // Calculate actually completed weeks
        let completedWeeks = 0
        M1_WEEKS.forEach((w) => {
          const isWeekDone = w.tasks.every((_, i) => S.tasks[w.id + "_" + i])
          if (isWeekDone) completedWeeks++
        })

        if (completedWeeks >= expectedWeek) {
          return `<div class="pace-nudge good"><i class="ph-fill ph-rocket-launch"></i> You are ahead of schedule! Expected Week: ${expectedWeek} | Completed: ${completedWeeks}</div>`
        } else {
          return `<div class="pace-nudge"><i class="ph-fill ph-warning-circle"></i> Catch-up Mode: You are in Week ${expectedWeek} but have only finished ${completedWeeks} weeks. Focus up!</div>`
        }
      }

      // --- INIT ---
      window.onscroll = function () {
        updateSidebarActive()
        handleScroll()
      }
      window.onload = () => {
        loadState()
        renderM1()
        renderFocus()
        syncJST()
        updateStats()
        renderTimerUI()

        document.getElementById("sessDisp").textContent = S.sessions || 0
        document.getElementById("timeDisp").textContent =
          Math.round(((S.sessions || 0) * 25) / 60) + "h"
      }
    </script>
  </body>
</html>
